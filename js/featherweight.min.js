window.matchMedia=window.matchMedia||function(e,t){"use strict";var n,r=e.documentElement,i=r.firstElementChild||r.firstChild,s=e.createElement("body"),o=e.createElement("div");o.id="mq-test-1";o.style.cssText="position:absolute;top:-100em";s.style.background="none";s.appendChild(o);return function(e){o.innerHTML='&shy;<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>';r.insertBefore(s,i);n=o.offsetWidth===42;r.removeChild(s);return{matches:n,media:e}}}(document);window.enquire=function(e){"use strict";function t(e,t){var n=0,r=e.length,i;for(n;n<r;n++){i=t(e[n],n);if(i===!1)break}}function n(e){return Object.prototype.toString.apply(e)==="[object Array]"}function r(e){return typeof e=="function"}function i(e){this.initialised=!1;this.options=e;e.deferSetup||this.setup()}function s(e,t){this.query=e;this.isUnconditional=t;this.handlers=[];this.matched=!1}function o(){if(!e)throw new Error("matchMedia is required");var t=new s("only all");this.queries={};this.listening=!1;this.browserIsIncapable=!t.matchMedia()}i.prototype={setup:function(e){this.options.setup&&this.options.setup(e);this.initialised=!0},on:function(e){this.initialised||this.setup(e);this.options.match(e)},off:function(e){this.options.unmatch&&this.options.unmatch(e)},destroy:function(){this.options.destroy?this.options.destroy():this.off()},equals:function(e){return this.options===e||this.options.match===e}};s.prototype={matchMedia:function(){return e(this.query).matches},addHandler:function(e,t){var n=new i(e);this.handlers.push(n);t&&this.matched&&n.on()},removeHandler:function(e){var n=this.handlers;t(n,function(t,r){if(t.equals(e)){t.destroy();return!n.splice(r,1)}})},assess:function(e){this.matchMedia()||this.isUnconditional?this.match(e):this.unmatch(e)},match:function(e){if(this.matched)return;t(this.handlers,function(t){t.on(e)});this.matched=!0},unmatch:function(e){if(!this.matched)return;t(this.handlers,function(t){t.off(e)});this.matched=!1}};o.prototype={register:function(e,i,o){var u=this.queries,a=o&&this.browserIsIncapable,f=this.listening;if(!u.hasOwnProperty(e)){u[e]=new s(e,a);this.listening&&u[e].assess()}r(i)&&(i={match:i});n(i)||(i=[i]);t(i,function(t){u[e].addHandler(t,f)});return this},unregister:function(e,n){var r=this.queries;if(!r.hasOwnProperty(e))return this;if(!n){t(this.queries[e].handlers,function(e){e.destroy()});delete r[e]}else r[e].removeHandler(n);return this},fire:function(e){var t=this.queries,n;for(n in t)t.hasOwnProperty(n)&&t[n].assess(e);return this},listen:function(e){function n(n){var r;window.addEventListener(n,function(n){r&&clearTimeout(r);r=setTimeout(function(){t.fire(n)},e)},!1)}var t=this;e=e||500;if(this.listening)return this;if(window.addEventListener){n("resize");n("orientationChange")}t.fire();this.listening=!0;return this}};return new o}(window.matchMedia);(function(e){function i(e){var t={};e.replace(/\&amp;/gi,"&").replace(/([^=&]+)=([^&]*)/g,function(e,n,r){t[decodeURIComponent(n)]=decodeURIComponent(r)});return t}function s(t,n,r){return'<iframe src="'+(n?"https://player.vimeo.com/video/"+t+"?"+e.param(r):"https://www.youtube.com/embed/"+t+"?"+e.param(r))+'" style="background:black;" frameborder="0" allowfullscreen allowtransparency="true"></iframe>'}function o(e){var t=e.attr("href"),n=t.indexOf("vimeo")>0,s=t.indexOf("?")?i(t.split("?").slice(-1)[0]):{},o=n?t.split("?")[0].split("/").slice(-1)[0]:s.v,u=e.attr("id")?e.attr("id"):e.attr("id",o+ ++r).attr("id");e.attr("href","#"+u).data({slug:o,href:t,ops:s,nonyt:n})}function u(t){var n=t.data("slug"),r=t.data("nonyt"),i=t.data("video-img-fallback")||"http://img.youtube.com/vi/"+n+"/mqdefault.jpg";console.log(n,r,i);r?e.ajax({url:"http://vimeo.com/api/v2/video/"+n+".json",dataType:"jsonp"}).then(function(e){t.css({"background-image":"url("+e[0].thumbnail_medium+")"})}):t.css({"background-image":"url("+i+")"})}function a(t,n){var r=t.data("slug"),i=t.data("nonyt"),o=t.data("ops");n=n?0:1;t.prepend(s(r,i,e.extend(o,{autoplay:n})))}function f(){t.find("a").not(".videoBgImgOn").each(function(){u(e(this).addClass("videoBgImgOn"))})}var t=e(".intrinsic"),n=700,r=0;t.find("a").each(function(){o(e(this).addClass("processed"))});enquire.register("screen and (min-width: "+n+"px)",{match:function(){t.find("a").not(".loaded").each(function(){a(e(this).addClass("loaded"),!0)})}},!0);enquire.register("screen and (max-width: "+(n-1)+"px)",{match:function(){f()}},!0);enquire.listen(500);t.on("click","a",function(){var n=e(this),r=n.data("nonyt"),i=n.data("slug"),o=n.data("ops")||{};t.find("a iframe").remove().removeClass("loaded");n.prepend(s(i,r,e.extend(o,{autoplay:1})))})})(jQuery);